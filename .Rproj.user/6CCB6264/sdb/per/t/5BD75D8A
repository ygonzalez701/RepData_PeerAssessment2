{
    "contents" : "##Read Data\ndata<-read.csv(\"repdata-data-StormData.csv.bz2\")\n\n##Load necessary Packages and set options\nlibrary(\"dplyr\")\nlibrary (\"ggplot2\")\nlibrary(\"gridExtra\")\noptions(scipen=999)\n\n#TRANSFORM DATA\n#Transform Date\ndata$BGN_DATE<-as.numeric(format(as.Date(data$BGN_DATE, format = \"%m/%d/%Y %H:%M:%S\"), \"%Y\"))\n\n#Transform Property multiplier\ndata$propMult[data$PROPDMGEXP == \"K\"] <- 1000\ndata$propMult[data$PROPDMGEXP == \"M\"] <- 1000000\ndata$propMult[data$PROPDMGEXP == \"\"] <- 1\ndata$propMult[data$PROPDMGEXP == \"B\"] <- 1000000000\ndata$propMult[data$PROPDMGEXP == \"m\"] <- 1000000\ndata$propMult[data$PROPDMGEXP == \"0\"] <- 1\ndata$propMult[data$PROPDMGEXP == \"5\"] <- 100000\ndata$propMult[data$PROPDMGEXP == \"6\"] <- 1000000\ndata$propMult[data$PROPDMGEXP == \"4\"] <- 10000\ndata$propMult[data$PROPDMGEXP == \"2\"] <- 100\ndata$propMult[data$PROPDMGEXP == \"3\"] <- 1000\ndata$propMult[data$PROPDMGEXP == \"h\"] <- 100\ndata$propMult[data$PROPDMGEXP == \"7\"] <- 10000000\ndata$propMult[data$PROPDMGEXP == \"H\"] <- 100\ndata$propMult[data$PROPDMGEXP == \"1\"] <- 10\ndata$propMult[data$PROPDMGEXP == \"8\"] <- 100000000\ndata$propMult[data$PROPDMGEXP == \"+\"] <- 0\ndata$propMult[data$PROPDMGEXP == \"-\"] <- 0\ndata$propMult[data$PROPDMGEXP == \"?\"] <- 0\n\ndata$newPROPDMG<-data$PROPDMG * data$propMult\n\n#Tranform Crop multiplier\ndata$cropMult[data$CROPDMGEXP == \"M\"] <- 1000000\ndata$cropMult[data$CROPDMGEXP == \"K\"] <- 1000\ndata$cropMult[data$CROPDMGEXP == \"m\"] <- 1000000\ndata$cropMult[data$CROPDMGEXP == \"B\"] <- 1000000000\ndata$cropMult[data$CROPDMGEXP == \"?\"] <- 0\ndata$cropMult[data$CROPDMGEXP == \"0\"] <- 0\ndata$cropMult[data$CROPDMGEXP == \"k\"] <- 1000\ndata$cropMult[data$CROPDMGEXP == \"2\"] <- 100\n\ndata$newCROPDMG<-data$CROPDMG * data$cropMult\n\ndata$newDMG<-(data$newPROPDMG + data$newCROPDMG)/1000000000\n\n##Plot events\nggplot(data, aes(BGN_DATE))+\n     geom_histogram(aes(fill=..count..))+\n     labs(title=(\"Events Observed From 1950 to 2011\"))+\n     labs(x=\"Year\", y=\"Number of Events\")\n#hist(data$BGN_DATE, breaks=30, main = \"No. of events collected over the Year\", xlab = \"Year\", ylab = \"No. of events\")\n\n##Slice the data to work only with years that have large observations\nhighData<-data[data$BGN_DATE>=1995,]\n\n#Summarise of Fatalities events and get the top 15 result \ndeaths <- aggregate(FATALITIES ~ EVTYPE, highData, sum)\ndeaths <- deaths[order(-deaths$FATALITIES), ][1:15, ]\ndeaths <- within(deaths, EVTYPE <- factor(x = EVTYPE, levels = deaths$EVTYPE))\n#Summarise of Injuries events and get the top 15 result \ninjuries <- aggregate(INJURIES ~ EVTYPE, highData, sum)\ninjuries <- injuries[order(-injuries$INJURIES), ][1:15, ]\ninjuries <- within(injuries, EVTYPE <- factor(x = EVTYPE, levels = injuries$EVTYPE))\n\n#Create Plot\nplotFatalities<-qplot(EVTYPE, data=deaths, weight=FATALITIES,\n     geom=\"bar\", binwidth=1)+\n     geom_bar(fill=\"lightgreen\")+\n     scale_y_continuous(\"FATALITIES\") + \n     theme(axis.text.x = element_text(angle = 90, \n                                      hjust = 1)) + xlab(\"Weather Event\") +\n     ggtitle(\"Total FATALITIES by Severe Weather\\n from 1995 - 2011\")\n\nplotInjuries<-qplot(EVTYPE, data=injuries, weight=INJURIES,\n      geom=\"bar\", binwidth=1)+\n     geom_bar(fill=\"lightblue\")+\n     scale_y_continuous(\"INJURIES\") + \n     theme(axis.text.x = element_text(angle = 90, \n                                      hjust = 1)) + xlab(\"Weather Event\") +\n     ggtitle(\"Total INJURIES by Severe Weather\\n from 1995 - 2011\")\n\ngrid.arrange(plotFatalities, plotInjuries, ncol = 2)\n\n#Summarise economic damage and get the top 15 results\necoDamage <- highData[order(-highData$newDMG),][1:15, ]\necoDamage <- within(ecoDamage, EVTYPE <- factor(x = EVTYPE, levels = ecoDamage$EVTYPE))\n\n##Plot Economic Damage\nqplot(EVTYPE, data=ecoDamage, weight=newDMG,\n                    geom=\"bar\", binwidth=1)+\n     geom_bar(fill=\"purple\")+\n     scale_y_continuous(\"Economic Damage (US$ Billions)\") + \n     theme(axis.text.x = element_text(angle = 90, \n                                      hjust = 1)) + xlab(\"Weather Event\") +\n     ggtitle(\"Total Economic (Property and Crops) Damage by\\n Severe Weather from 1995 - 2011\")\n\n",
    "created" : 1447627613359.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "231057091",
    "id" : "5BD75D8A",
    "lastKnownWriteTime" : 1447712012,
    "path" : "~/Statistical Studies/The Data Science Track/Reproducible Research/Assignment 2/Assignment2.R",
    "project_path" : "Assignment2.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}